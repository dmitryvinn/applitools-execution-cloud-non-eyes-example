"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.makeGetTypedEyes = void 0;
function makeGetTypedEyes({ type: defaultType, settings: defaultSettings, target, cores, logger: mainLogger, }) {
    let eyes;
    return async function getTypedEyes({ type = defaultType, settings, logger = mainLogger, } = {}) {
        logger = logger.extend(mainLogger);
        if (!eyes) {
            eyes = await cores[type].openEyes({ target, settings: defaultSettings, logger });
            return eyes;
        }
        else if (eyes.type === type) {
            return eyes;
        }
        else if (type === 'ufg') {
            const base = await eyes.getBaseEyes({ logger });
            const typedEyes = await cores.ufg.openEyes({ target, settings: defaultSettings, base, logger });
            return typedEyes;
        }
        else {
            const base = (await Promise.all(settings.map(settings => eyes.getBaseEyes({ settings, logger })))).flat();
            const typedEyes = await cores.classic.openEyes({ target, settings: defaultSettings, base, logger });
            return typedEyes;
        }
    };
}
exports.makeGetTypedEyes = makeGetTypedEyes;
